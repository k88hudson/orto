{"version":3,"sources":["utils/firestore.ts","ActiveTrials/ActiveTrials.tsx","AuthButtons/AuthButtons.tsx","MyTokens/MyTokens.tsx","NewToken/NewToken.tsx","NewTrial/NewTrial.tsx","App/App.tsx","index.tsx"],"names":["firebase","apps","length","app","console","log","initializeApp","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","typedConverter","toFirestore","data","fromFirestore","snap","id","auth","firestore","db","tokens","collection","withConverter","features","addToken","token","request","createdAt","FieldValue","serverTimestamp","add","useCurrentUser","useState","currentUser","setCurrentUser","useEffect","onAuthStateChanged","user","ActiveTrials","setFeatures","where","get","then","qSnapshot","forEach","doc","push","catch","error","useFeatures","className","map","feature","style","width","name","description","to","signInWithGoogle","e","preventDefault","provider","GoogleAuthProvider","signInWithPopup","SignIn","onClick","SignOut","signOut","TokenRow","tokenEl","useRef","featureId","origin","expiry","Date","toLocaleDateString","value","readOnly","ref","current","select","document","execCommand","tokenId","delete","MyTokens","uid","setTokens","onSnapshot","size","updatedTokens","useTokens","href","TERMS","NewToken","history","useHistory","useParams","originRef","isSubdomain","newToken","setNewToken","setFeature","useFeature","onFormSubmit","a","onSubmit","learnMoreLink","target","rel","htmlFor","required","placeholder","onChange","candidate","url","URL","includes","protocol","validateUrl","setCustomValidity","type","checked","term","i","fields","key","label","NewTrial","archived","newFeature","setNewFeature","values","App","exact","activeClassName","email","path","ReactDOM","render","StrictMode","getElementById"],"mappings":"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","file":"static/js/main.a3efce29.chunk.js","sourcesContent":["import firebase from \"firebase/app\";\nimport \"firebase/firestore\";\nimport \"firebase/auth\";\nimport { useEffect, useState } from \"react\";\nimport { Token, TokenRequest, Feature } from \"../../types/Orto\";\n\nexport function initialize() {\n  if (!firebase.apps.length) {\n    console.log(\"INIT FIRESTORE\");\n    firebase.initializeApp({\n      apiKey: \"AIzaSyD9yol-9NCX10hRb33MjRxLW1I2BnCatPU\",\n      authDomain: \"orto-408ca.firebaseapp.com\",\n      projectId: \"orto-408ca\",\n      storageBucket: \"orto-408ca.appspot.com\",\n      messagingSenderId: \"938595199529\",\n      appId: \"1:938595199529:web:2861c65a221c3dec7a8a38\",\n    });\n  } else {\n    firebase.app();\n  }\n}\n\n// We have to initialize before any other files use firebase.\ninitialize();\n\nconst typedConverter = <T>() => ({\n  toFirestore: (data: T) => data,\n  fromFirestore: (snap: firebase.firestore.QueryDocumentSnapshot) => {\n    return {\n      ...(snap.data() as T),\n      id: snap.id,\n    } as T;\n  },\n});\n\nexport const auth = firebase.auth();\nexport const firestore = firebase.firestore();\nexport const db = {\n  tokens: firestore.collection(\"tokens\").withConverter(typedConverter<Token>()),\n  features: firestore\n    .collection(\"features\")\n    .withConverter(typedConverter<Feature>()),\n};\n\nexport function useTokens(uid?: string) {\n  const [tokens, setTokens] = useState<Array<Token>>([]);\n  useEffect(() => {\n    if (uid) {\n      const unsubscribe = db.tokens\n        .where(\"uid\", \"==\", uid)\n        .onSnapshot((qSnapshot) => {\n          if (!qSnapshot.size) {\n            setTokens([]);\n            return;\n          }\n          const updatedTokens: Array<Token> = [];\n          qSnapshot.forEach((doc) => {\n            const data = doc.data();\n            updatedTokens.push(data);\n          });\n          setTokens(updatedTokens);\n        });\n      return unsubscribe;\n    }\n  }, [uid]);\n  return [tokens];\n}\n\nexport function addToken(token: TokenRequest) {\n  const request = {\n    ...token,\n    createdAt: firebase.firestore.FieldValue.serverTimestamp(),\n  };\n\n  return (\n    db.tokens\n      // id is added automatically\n      .add(request as Token)\n  );\n}\n\nexport function deleteToken(tokenId: string) {\n  db.tokens\n    .doc(tokenId)\n    .delete()\n    .then((value) => {\n      console.log(value);\n    })\n    .catch((error) => {\n      console.log(error);\n    });\n}\n\nexport function useFeatures() {\n  const [features, setFeatures] = useState<Array<Feature>>([]);\n  useEffect(() => {\n    db.features\n      .where(\"archived\", \"!=\", true)\n      .get()\n      .then((qSnapshot) => {\n        const features: Array<Feature> = [];\n        qSnapshot.forEach((doc) => features.push(doc.data()));\n        setFeatures(features);\n      })\n      .catch((error) => console.log(error));\n  }, []);\n  return [features];\n}\n\nexport function useFeature(featureId: string) {\n  const [feature, setFeature] = useState<Feature>();\n  useEffect(() => {\n    return db.features.doc(featureId).onSnapshot((doc) => {\n      setFeature(doc.data());\n    });\n  }, []);\n  return feature;\n}\n\nexport function useCurrentUser() {\n  const [currentUser, setCurrentUser] = useState<firebase.User | null>(null);\n  useEffect(() => {\n    return auth.onAuthStateChanged((user) => {\n      setCurrentUser(user);\n    });\n  }, []);\n  return [currentUser];\n}\n","import { useFeatures } from \"../utils/firestore\";\nimport { Link } from \"react-router-dom\";\n\nexport function ActiveTrials() {\n  const [features] = useFeatures();\n  return (\n    <div>\n      <table className=\"table align-middle\">\n        <tbody>\n          {features?.map((feature) => (\n            <tr key={feature.id}>\n              <td style={{ width: \"33%\" }}>\n                <strong>{feature.name}</strong>\n              </td>\n              <td>{feature.description}</td>\n              <td>\n                <Link className=\"btn btn-primary\" to={`/new/${feature.id}`}>\n                  Register\n                </Link>\n              </td>\n            </tr>\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","import firebase from \"firebase/app\";\nimport { auth } from \"../utils/firestore\";\n\nexport function signInWithGoogle(e: React.SyntheticEvent) {\n  e.preventDefault();\n  const provider = new firebase.auth.GoogleAuthProvider();\n  auth.signInWithPopup(provider).catch((e) => {\n    console.log(e);\n  });\n}\n\nexport function SignIn() {\n  return (\n    <button className=\"btn btn-primary\" onClick={signInWithGoogle}>\n      Sign In\n    </button>\n  );\n}\n\nexport function SignOut() {\n  return (\n    <button\n      className=\"btn btn-outline-secondary\"\n      onClick={(e) => {\n        e.preventDefault();\n        auth.signOut();\n      }}\n    >\n      Sign out\n    </button>\n  );\n}\n","import { useRef } from \"react\";\nimport { deleteToken, useCurrentUser, useTokens } from \"../utils/firestore\";\nimport { signInWithGoogle } from \"../AuthButtons/AuthButtons\";\nimport { Token } from \"../../types/Orto\";\n\nfunction TokenRow({ token }: { token: Token }) {\n  const tokenEl = useRef<HTMLInputElement>(null);\n  return (\n    <tr key={token.id}>\n      <td>{token.featureId}</td>\n      <td>{token.origin}</td>\n      <td>{token.expiry && new Date(token.expiry).toLocaleDateString()}</td>\n      <td>\n        {token.token ? (\n          <input\n            className=\"form-control\"\n            value={token.token}\n            readOnly={true}\n            ref={tokenEl}\n          />\n        ) : (\n          \"Generating token...\"\n        )}\n      </td>\n\n      <td>\n        {token.token && (\n          <button\n            className=\"btn btn-primary\"\n            onClick={(e) => {\n              e.preventDefault();\n              if (tokenEl.current) {\n                tokenEl.current.select();\n                document.execCommand(\"copy\");\n              }\n            }}\n          >\n            Copy\n          </button>\n        )}{\" \"}\n        <button\n          className=\"btn btn-secondary\"\n          onClick={(e) => {\n            e.preventDefault();\n            deleteToken(token.id);\n          }}\n        >\n          Delete\n        </button>\n      </td>\n    </tr>\n  );\n}\n\nexport function MyTokens() {\n  const [currentUser] = useCurrentUser();\n  const uid = currentUser?.uid;\n  const [tokens] = useTokens(uid);\n\n  console.log(tokens);\n  if (!uid) {\n    return (\n      <div>\n        Please{\" \"}\n        <a href=\"#\" onClick={signInWithGoogle}>\n          sign in\n        </a>{\" \"}\n        to see your tokens.\n      </div>\n    );\n  }\n  return (\n    <div>\n      <table className=\"table align-middle\">\n        <thead>\n          <tr>\n            <th>Feature</th>\n            <th>Origin</th>\n            <th>Expires</th>\n            <th>Token</th>\n            <th></th>\n          </tr>\n        </thead>\n        <tbody>\n          {tokens?.map((token) => (\n            <TokenRow key={token.id} token={token} />\n          ))}\n        </tbody>\n      </table>\n    </div>\n  );\n}\n","import React, { useRef, useState } from \"react\";\nimport { addToken, useCurrentUser, useFeature } from \"../utils/firestore\";\nimport { TokenRequest } from \"../../types/Orto\";\nimport { useParams, useHistory } from \"react-router-dom\";\nimport { signInWithGoogle } from \"../AuthButtons/AuthButtons\";\n\nconst TERMS = [\n  \"I understand that this feature is experimental and may at any point become unavailable, and may never be enabled beyond this experiment, and even if Firefox decides to enable the feature after this trial, it will be unavailable for some time.\",\n  \"I understand that this feature may change throughout the course of the trial.\",\n  \"Where possible, I agree to apply feature detection / graceful degradation to handle the case where the experimental feature is unavailable.\",\n];\n\nfunction validateUrl(candidate: string) {\n  let url: URL;\n  try {\n    url = new URL(candidate);\n  } catch (e) {\n    return false;\n  }\n  if (![\"http:\", \"https:\"].includes(url.protocol)) return false;\n  return true;\n}\n\nexport function NewToken() {\n  const [currentUser] = useCurrentUser();\n  const uid = currentUser?.uid;\n  const history = useHistory();\n  const { featureId } = useParams<{ featureId: string }>();\n  const originRef = useRef<HTMLInputElement>(null);\n  const [newToken, setNewToken] = useState<\n    Omit<TokenRequest, \"uid\" | \"featureId\">\n  >({\n    origin: \"\",\n    isSubdomain: false,\n  });\n\n  const feature = useFeature(featureId);\n  const onFormSubmit = async (e: React.SyntheticEvent) => {\n    e.preventDefault();\n\n    const { origin, isSubdomain } = newToken;\n    if (!uid || !origin || !featureId) {\n      return;\n    }\n\n    const ref = await addToken({\n      uid: uid,\n      origin,\n      featureId,\n      isSubdomain,\n    });\n    console.log(ref.id);\n    history.push(\"/my\");\n  };\n  if (!feature) {\n    return <div>Loading...</div>;\n  }\n  if (!uid) {\n    return (\n      <div>\n        Please{\" \"}\n        <a href=\"#\" onClick={signInWithGoogle}>\n          sign in\n        </a>{\" \"}\n        to create a token.\n      </div>\n    );\n  }\n  return (\n    <div className=\"row\">\n      <form onSubmit={onFormSubmit} className=\"col-lg-8\">\n        <h2 className=\"mb-2\">Create token for {feature.name}</h2>\n        <p className=\"mb-4\">\n          {feature.description}\n          {feature.learnMoreLink && (\n            <>\n              <br />\n              <a href={feature.learnMoreLink} target=\"_blank\" rel=\"noreferrer\">\n                Learn More\n              </a>\n            </>\n          )}\n        </p>\n\n        <div className=\"mb-3\">\n          <label className=\"form-label\" htmlFor=\"origin-input\">\n            Web Origin\n          </label>\n          <input\n            id=\"origin-input\"\n            required\n            className=\"form-control\"\n            placeholder=\"https://foo.com\"\n            ref={originRef}\n            value={newToken.origin}\n            onChange={(e) => {\n              setNewToken({ ...newToken, origin: e.target.value });\n              if (e.target.value && validateUrl(e.target.value)) {\n                originRef.current?.setCustomValidity(\"\");\n              } else {\n                originRef.current?.setCustomValidity(\n                  \"Origin must be a valid url starting with http or https\"\n                );\n              }\n            }}\n          />\n        </div>\n        <div className=\"mb-3\">\n          <div className=\"form-check\">\n            <input\n              className=\"form-check-input\"\n              type=\"checkbox\"\n              id=\"isSubdomain-input\"\n              checked={newToken.isSubdomain}\n              onChange={(e) =>\n                setNewToken({ ...newToken, isSubdomain: e.target.checked })\n              }\n            />\n            <label className=\"form-check-label\" htmlFor=\"isSubdomain-input\">\n              I need a token to match all subdomains of the origin.\n            </label>\n          </div>\n        </div>\n\n        <div className=\"alert alert-warning mb-4\">\n          <p>Terms and conditions</p>\n          {TERMS.map((term, i) => (\n            <div key={i} className=\"form-check\">\n              <input\n                id={`term-${i}`}\n                type=\"checkbox\"\n                required\n                className=\"form-check-input\"\n              />\n              <label htmlFor={`term-${i}`} className=\"form-check-label\">\n                {term}\n              </label>\n            </div>\n          ))}\n        </div>\n        <div className=\"mb-3\">\n          <button className=\"btn btn-primary\">Register</button>\n        </div>\n      </form>\n    </div>\n  );\n}\n","import { Feature } from \"../../types/Orto\";\nimport { useState } from \"react\";\n\ninterface Field {\n  key: keyof Feature;\n  label: string;\n}\n\nconst fields: Array<Field> = [\n  { key: \"id\", label: \"Feature ID\" },\n  { key: \"name\", label: \"Name\" },\n  { key: \"description\", label: \"Description\" },\n  { key: \"learnMoreLink\", label: \"Learn More Link\" },\n];\n\nexport function NewTrial() {\n  const [newFeature, setNewFeature] = useState<Feature>({\n    id: \"\",\n    name: \"\",\n    description: \"\",\n    learnMoreLink: \"\",\n    archived: false,\n  });\n  const updateNewFeature = (values: Partial<Feature>) => {\n    setNewFeature({ ...newFeature, ...values });\n  };\n  return (\n    <form\n      className=\"form\"\n      onSubmit={(e) => {\n        e.preventDefault();\n        console.log(newFeature);\n      }}\n    >\n      <h3>Create a Trial</h3>\n      {fields.map(({ key, label }) => (\n        <div className=\"mb-3\" key={key}>\n          <label className=\"form-label\" htmlFor={`${key}-input`}>\n            {label}\n          </label>\n          <input\n            id={`${key}-input`}\n            required\n            className=\"form-control\"\n            value={newFeature[key] as string}\n            onChange={(e) => updateNewFeature({ [key]: e.target.value })}\n          />\n        </div>\n      ))}\n      <button className=\"btn btn-primary\">Create</button>\n    </form>\n  );\n}\n","import { useCurrentUser } from \"../utils/firestore\";\nimport {\n  HashRouter as Router,\n  Switch,\n  Route,\n  Link,\n  NavLink,\n} from \"react-router-dom\";\nimport { ActiveTrials } from \"../ActiveTrials/ActiveTrials\";\nimport { SignIn, SignOut } from \"../AuthButtons/AuthButtons\";\nimport { MyTokens } from \"../MyTokens/MyTokens\";\nimport { NewToken } from \"../NewToken/NewToken\";\nimport { NewTrial } from \"../NewTrial/NewTrial\";\n\nfunction App() {\n  const [currentUser] = useCurrentUser();\n  const uid = currentUser?.uid;\n  return (\n    <Router>\n      <nav className=\"navbar navbar-expand-lg navbar-dark bg-dark\">\n        <div className=\"container\">\n          <Link className=\"navbar-brand\" to=\"/\">\n            Origin trials\n          </Link>\n          <button\n            className=\"navbar-toggler\"\n            type=\"button\"\n            data-bs-toggle=\"collapse\"\n            data-bs-target=\"#navbarSupportedContent\"\n            aria-controls=\"navbarSupportedContent\"\n            aria-expanded=\"false\"\n            aria-label=\"Toggle navigation\"\n          >\n            <span className=\"navbar-toggler-icon\"></span>\n          </button>\n          <div className=\"collapse navbar-collapse\" id=\"navbarSupportedContent\">\n            <ul className=\"navbar-nav me-auto mb-2 mb-lg-0\">\n              <li className=\"nav-item\">\n                <NavLink\n                  exact\n                  className=\"nav-link\"\n                  activeClassName=\"active\"\n                  aria-current=\"page\"\n                  to=\"/\"\n                >\n                  Active trials\n                </NavLink>\n              </li>\n              {currentUser && (\n                <li className=\"nav-item\">\n                  <NavLink\n                    className=\"nav-link\"\n                    activeClassName=\"active\"\n                    aria-current=\"page\"\n                    to=\"/my\"\n                  >\n                    My tokens\n                  </NavLink>\n                </li>\n              )}\n            </ul>\n\n            <form className=\"d-flex\">\n              {\" \"}\n              <span className=\"collapse navbar-collapse me-2 text-light\">\n                {currentUser?.email}\n              </span>\n              {uid ? <SignOut /> : <SignIn />}\n            </form>\n          </div>\n        </div>\n      </nav>\n\n      <main className=\"container pt-4\">\n        <Switch>\n          <Route path=\"/my\">\n            <MyTokens />\n          </Route>\n          <Route path=\"/new/:featureId\">\n            <NewToken />\n          </Route>\n          <Route path=\"/new-trial\">\n            <NewTrial />\n          </Route>\n          <Route path=\"/\">\n            <ActiveTrials />\n          </Route>\n        </Switch>\n      </main>\n    </Router>\n  );\n}\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"./index.css\";\nimport App from \"./App/App\";\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById(\"root\")\n);\n"],"sourceRoot":""}